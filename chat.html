<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ninja Squad Chat - War Room</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;500;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Cairo', 'sans-serif'] },
                    colors: {
                        ninja: '#ccff00',
                        dark: { 900: '#050505', 800: '#0a0a0a', 700: '#121212', card: '#1a1a1a' }
                    },
                    animation: {
                        'pulse-glow': 'pulse-glow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        'pulse-glow': {
                            '0%, 100%': { opacity: '1', boxShadow: '0 0 10px #ccff00' },
                            '50%': { opacity: '.5', boxShadow: '0 0 20px #ccff00' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #050505; color: white; }
        .glass-panel { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.05); }
        
        /* Chat Bubbles */
        .bubble-me { background: rgba(204, 255, 0, 0.1); border: 1px solid rgba(204, 255, 0, 0.2); color: #eeffcc; border-radius: 16px 16px 0 16px; }
        .bubble-other { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.05); color: #ccc; border-radius: 16px 16px 16px 0; }
        .bubble-ai { background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(5, 5, 5, 0.8) 100%); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 16px; }

        .typing-dot {
            width: 6px; height: 6px; background: #888; border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out both;
        }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
    </style>
</head>
<body class="flex h-screen overflow-hidden bg-dark-900">

    <!-- Sidebar (Context) -->
    <aside class="w-72 bg-dark-800 border-l border-white/5 flex flex-col hidden md:flex">
        <div class="p-6 border-b border-white/5">
            <h2 class="text-xl font-bold flex items-center gap-2">
                <span class="text-ninja">#</span> Pepsi Campaign
            </h2>
            <p class="text-xs text-gray-500 mt-1">Ù…Ø´Ø±ÙˆØ¹ Ù†Ø´Ø· â€¢ 5 Ø£Ø¹Ø¶Ø§Ø¡</p>
        </div>
        
        <div class="flex-1 overflow-y-auto p-4 space-y-4">
            <div class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-2">Ø§Ù„Ù…ØªÙˆØ§Ø¬Ø¯ÙˆÙ† (Squad)</div>
            <!-- User 1 -->
            <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-white/5 cursor-pointer">
                <div class="relative">
                    <img src="https://i.pravatar.cc/150?u=1" class="w-10 h-10 rounded-full border border-white/10">
                    <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-dark-800"></div>
                </div>
                <div>
                    <div class="text-sm font-bold">Sarah (Art Dir)</div>
                    <div class="text-xs text-ninja">ÙŠØªÙ… Ø§Ù„ÙƒØªØ§Ø¨Ø©...</div>
                </div>
            </div>
             <!-- User 2 -->
             <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-white/5 cursor-pointer">
                <div class="relative">
                    <img src="https://i.pravatar.cc/150?u=2" class="w-10 h-10 rounded-full border border-white/10">
                    <div class="absolute bottom-0 right-0 w-3 h-3 bg-gray-500 rounded-full border-2 border-dark-800"></div>
                </div>
                <div>
                    <div class="text-sm font-bold">Mike (Copy)</div>
                    <div class="text-xs text-gray-500">Ù…Ù†Ø° 5 Ø¯</div>
                </div>
            </div>
        </div>

        <!-- AI Action Button -->
        <div class="p-4 border-t border-white/5">
            <button onclick="activateGeminiProtocol()" class="w-full py-3 bg-gradient-to-r from-purple-600 to-blue-600 rounded-xl font-bold text-white flex items-center justify-center gap-2 hover:opacity-90 transition-opacity shadow-lg shadow-purple-500/20 group">
                <i data-lucide="sparkles" class="w-5 h-5 group-hover:rotate-12 transition-transform"></i>
                ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© (Gemini)
            </button>
        </div>
    </aside>

    <!-- Main Chat Area -->
    <main class="flex-1 flex flex-col relative">
        <!-- Header -->
        <header class="h-16 border-b border-white/5 flex items-center justify-between px-6 bg-dark-800/80 backdrop-blur">
            <div class="flex items-center gap-4">
                <div class="md:hidden text-gray-400"><i data-lucide="menu"></i></div>
                <div>
                    <h1 class="font-bold">General Chat</h1>
                    <p class="text-xs text-green-500 flex items-center gap-1"><span class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></span> Ù…ØªØµÙ„ ÙˆÙ…Ø´ÙØ±</p>
                </div>
            </div>
            <div class="flex gap-4">
                <button class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center hover:bg-white/10"><i data-lucide="search" class="w-4 h-4"></i></button>
                <button class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center hover:bg-white/10"><i data-lucide="phone" class="w-4 h-4"></i></button>
                <button class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center hover:bg-white/10"><i data-lucide="video" class="w-4 h-4"></i></button>
            </div>
        </header>

        <!-- Messages Area -->
        <div id="chatContainer" class="flex-1 overflow-y-auto p-6 space-y-6 scroll-smooth">
            
            <!-- Date Separator -->
            <div class="flex justify-center"><span class="bg-white/5 px-3 py-1 rounded-full text-xs text-gray-500">Ø§Ù„ÙŠÙˆÙ…ØŒ 10:30 Øµ</span></div>

            <!-- Msg 1 -->
            <div class="flex gap-4 chat-message" data-sender="Sarah">
                <img src="https://i.pravatar.cc/150?u=1" class="w-10 h-10 rounded-full border border-white/10 mt-1">
                <div class="max-w-[70%]">
                    <div class="flex items-baseline gap-2 mb-1">
                        <span class="text-sm font-bold text-white">Sarah</span>
                        <span class="text-xs text-gray-500">10:30 AM</span>
                    </div>
                    <div class="bubble-other p-4 text-sm leading-relaxed">
                        ÙŠØ§ Ø´Ø¨Ø§Ø¨ØŒ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù„Ø³Ù‡ Ø¨Ø§Ø¹Øª ÙÙŠØ¯Ø¨Ø§Ùƒ Ø¹Ù„Ù‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø£Ø®ÙŠØ±. Ø¨ÙŠÙ‚ÙˆÙ„ÙˆØ§ Ø§Ù„Ø£Ù„ÙˆØ§Ù† "ÙƒØ¦ÙŠØ¨Ø©" ÙˆÙ…Ø­ØªØ§Ø¬ÙŠÙ† Ù†ØºÙŠØ± Ø§Ù„Ù€ Intro Ø¨Ø§Ù„ÙƒØ§Ù…Ù„. ğŸ˜¤
                    </div>
                </div>
            </div>

            <!-- Msg 2 -->
            <div class="flex gap-4 chat-message" data-sender="Mike">
                <img src="https://i.pravatar.cc/150?u=2" class="w-10 h-10 rounded-full border border-white/10 mt-1">
                <div class="max-w-[70%]">
                    <div class="flex items-baseline gap-2 mb-1">
                        <span class="text-sm font-bold text-white">Mike</span>
                        <span class="text-xs text-gray-500">10:32 AM</span>
                    </div>
                    <div class="bubble-other p-4 text-sm leading-relaxed">
                        ØªØ§Ù†ÙŠØŸ! Ø¥Ø­Ù†Ø§ Ù„Ø³Ù‡ Ù…ØºÙŠØ±ÙŠÙ†Ù‡Ø§ Ø§Ù…Ø¨Ø§Ø±Ø­. Ø·ÙŠØ¨ Ù‡Ù…Ø§ Ø¨Ø¹ØªÙˆØ§ Ø£ÙŠ Ø±ÙŠÙØ±Ø§Ù†Ø³ (Reference) Ù„Ù„Ø´ÙƒÙ„ Ø§Ù„Ù„ÙŠ Ø¹Ø§ÙŠØ²ÙŠÙ†Ù‡ØŸ
                    </div>
                </div>
            </div>

            <!-- Msg 3 (Me) -->
            <div class="flex gap-4 flex-row-reverse chat-message" data-sender="Me">
                <img src="https://i.pravatar.cc/150?u=3" class="w-10 h-10 rounded-full border border-white/10 mt-1">
                <div class="max-w-[70%]">
                    <div class="flex items-baseline gap-2 mb-1 flex-row-reverse">
                        <span class="text-sm font-bold text-ninja">Ø£Ù†Ø§</span>
                        <span class="text-xs text-gray-500">10:35 AM</span>
                    </div>
                    <div class="bubble-me p-4 text-sm leading-relaxed">
                        Ù…Ø´ Ù…Ø´ÙƒÙ„Ø©ØŒ Ø®Ù„ÙŠÙ†Ø§ Ù†Ù†Ø¬Ø². ÙŠØ§ Ø³Ø§Ø±Ø©ØŒ Ø§Ø¨Ø¹ØªÙŠÙ„ÙŠ Ù…Ù„ÙØ§Øª Ø§Ù„Ù€ After Effects ÙˆØ£Ù†Ø§ Ù‡Ø¹Ø¯Ù„ Ø§Ù„Ø£Ù„ÙˆØ§Ù†. ÙˆÙ…Ø§ÙŠÙƒØŒ Ø¬Ù‡Ø²Ù„ÙŠ Ø³ÙƒØ±ÙŠØ¨Øª Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù€ Intro ÙŠÙƒÙˆÙ† "Ù…Ø¨Ù‡Ø¬" Ø£ÙƒØªØ± Ø®Ù„Ø§Ù„ Ø³Ø§Ø¹Ø©.
                    </div>
                </div>
            </div>

            <!-- Msg 4 -->
            <div class="flex gap-4 chat-message" data-sender="Sarah">
                <img src="https://i.pravatar.cc/150?u=1" class="w-10 h-10 rounded-full border border-white/10 mt-1">
                <div class="max-w-[70%]">
                    <div class="flex items-baseline gap-2 mb-1">
                        <span class="text-sm font-bold text-white">Sarah</span>
                        <span class="text-xs text-gray-500">10:36 AM</span>
                    </div>
                    <div class="bubble-other p-4 text-sm leading-relaxed">
                        ØªÙ…Ø§Ù…ØŒ Ù‡Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø­Ø§Ù„Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø§ÙŠÙ. ğŸ‘
                    </div>
                </div>
            </div>

        </div>

        <!-- AI Loading Overlay (Hidden) -->
        <div id="aiProcessing" class="absolute inset-0 bg-dark-900/80 backdrop-blur z-50 hidden flex flex-col items-center justify-center">
            <div class="w-20 h-20 relative flex items-center justify-center mb-4">
                <div class="absolute inset-0 border-4 border-purple-500/30 rounded-full"></div>
                <div class="absolute inset-0 border-4 border-purple-500 border-t-transparent rounded-full animate-spin"></div>
                <i data-lucide="bot" class="w-8 h-8 text-purple-400"></i>
            </div>
            <h3 class="text-xl font-bold text-white mb-2">Gemini Protocol Active</h3>
            <p class="text-sm text-gray-400">Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© ÙˆØ§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ù‡Ø§Ù…...</p>
        </div>

        <!-- Input Area -->
        <div class="p-6 bg-dark-800 border-t border-white/5">
            <div class="bg-dark-900 border border-white/10 rounded-2xl p-2 flex items-end gap-2 focus-within:border-ninja transition-colors">
                <button class="p-3 text-gray-400 hover:text-white hover:bg-white/5 rounded-xl"><i data-lucide="paperclip" class="w-5 h-5"></i></button>
                <textarea placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." class="flex-1 bg-transparent text-white text-sm p-3 max-h-32 outline-none resize-none placeholder-gray-600" rows="1"></textarea>
                <button class="p-3 bg-ninja text-black rounded-xl hover:bg-lime-400 font-bold shadow-[0_0_10px_rgba(204,255,0,0.2)] transition-all hover:scale-105"><i data-lucide="send-horizontal" class="w-5 h-5"></i></button>
            </div>
        </div>
    </main>

    <script>
        lucide.createIcons();

        // --- GEMINI LOGIC ---
        const apiKey = ""; // Ø§Ù„Ø­Ù‚Ù† Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ

        async function activateGeminiProtocol() {
            const chatContainer = document.getElementById('chatContainer');
            const loader = document.getElementById('aiProcessing');
            
            // 1. Collect Chat History
            const messages = Array.from(document.querySelectorAll('.chat-message')).map(msg => {
                const sender = msg.getAttribute('data-sender');
                const text = msg.querySelector('.leading-relaxed').innerText;
                return `${sender}: ${text}`;
            }).join('\n');

            // 2. Show Loader
            loader.classList.remove('hidden');

            // 3. Prepare Prompt
            const prompt = `
                Act as a Project Manager Assistant AI. Analyze the following chat history from an agency team working on "Pepsi Campaign".
                
                Chat History:
                ${messages}

                Output Requirements:
                1. Summarize the conflict/issue in 1 sentence (Arabic).
                2. Extract action items (Tasks) assigned to people. Return as JSON array: [{ "assignee": "Name", "task": "Task description", "deadline": "Time mentioned or ASAP" }].
                
                Format response as clean HTML snippet to be injected into a chat bubble (Use Tailwind classes provided in context: bg-dark-800, text-white, border-purple-500).
                Do not include markdown ticks.
            `;

            // 4. Call API (Simulated if no key)
            let aiResponseHtml = "";
            try {
                // Real API Call block (commented out for safety if no key, acts as fallback)
                /*
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                const data = await response.json();
                const rawText = data.candidates[0].content.parts[0].text;
                // Here we would parse the rawText to HTML
                */

                // SIMULATED RESPONSE (For Demo Perfection)
                await new Promise(r => setTimeout(r, 2000)); // Fake delay
                
                aiResponseHtml = `
                    <div class="flex gap-4 mt-6 animate-fade-in-up">
                        <div class="w-10 h-10 rounded-full bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center shrink-0 shadow-lg shadow-purple-500/20 border border-white/10">
                            <i data-lucide="bot" class="w-6 h-6 text-white"></i>
                        </div>
                        <div class="max-w-[85%] w-full">
                            <div class="flex items-baseline gap-2 mb-1">
                                <span class="text-sm font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-blue-400">Gemini AI</span>
                                <span class="text-xs text-gray-500">Ø§Ù„Ø¢Ù†</span>
                            </div>
                            <div class="bubble-ai p-6 relative overflow-hidden">
                                <!-- Background Glow -->
                                <div class="absolute top-0 right-0 w-32 h-32 bg-purple-500/10 rounded-full blur-2xl -translate-y-1/2 translate-x-1/2"></div>
                                
                                <h3 class="font-bold text-lg mb-2 flex items-center gap-2 text-white">
                                    <i data-lucide="file-text" class="w-4 h-4 text-purple-400"></i>
                                    ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù‡Ù…Ø© (Mission Report)
                                </h3>
                                
                                <p class="text-gray-300 text-sm mb-4 border-b border-white/10 pb-4">
                                    Ø§Ù„Ø¹Ù…ÙŠÙ„ ØºÙŠØ± Ø±Ø§Ø¶Ù Ø¹Ù† Ø£Ù„ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙˆÙŠØ·Ù„Ø¨ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù€ Intro Ù„ØªÙƒÙˆÙ† "Ù…Ø¨Ù‡Ø¬Ø©" Ø£ÙƒØ«Ø±.
                                </p>

                                <div class="space-y-3">
                                    <!-- Extracted Task 1 -->
                                    <div class="bg-dark-900/50 p-3 rounded-xl border border-white/5 flex justify-between items-center group hover:border-ninja/30 transition-colors">
                                        <div class="flex items-center gap-3">
                                            <div class="w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center text-green-400 font-bold text-xs">SA</div>
                                            <div>
                                                <div class="text-sm font-bold text-white">ØªØ¹Ø¯ÙŠÙ„ Ø£Ù„ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</div>
                                                <div class="text-[10px] text-gray-400">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: Sarah â€¢ Ø§Ù„Ù…ÙˆØ¹Ø¯: ASAP</div>
                                            </div>
                                        </div>
                                        <button class="bg-ninja text-black px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-lime-400 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                            <i data-lucide="plus" class="w-3 h-3"></i> Ø¥Ù†Ø´Ø§Ø¡
                                        </button>
                                    </div>

                                    <!-- Extracted Task 2 -->
                                    <div class="bg-dark-900/50 p-3 rounded-xl border border-white/5 flex justify-between items-center group hover:border-ninja/30 transition-colors">
                                        <div class="flex items-center gap-3">
                                            <div class="w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 font-bold text-xs">MI</div>
                                            <div>
                                                <div class="text-sm font-bold text-white">ÙƒØªØ§Ø¨Ø© Ø³ÙƒØ±ÙŠØ¨Øª Intro Ø¬Ø¯ÙŠØ¯</div>
                                                <div class="text-[10px] text-gray-400">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: Mike â€¢ Ø§Ù„Ù…ÙˆØ¹Ø¯: Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©</div>
                                            </div>
                                        </div>
                                        <button class="bg-ninja text-black px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-lime-400 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                            <i data-lucide="plus" class="w-3 h-3"></i> Ø¥Ù†Ø´Ø§Ø¡
                                        </button>
                                    </div>
                                </div>

                                <div class="mt-4 pt-3 border-t border-white/10 flex justify-end">
                                    <button class="text-xs text-gray-400 hover:text-white flex items-center gap-1">
                                        Ù‡Ù„ Ø§Ù„ØªÙ„Ø®ÙŠØµ Ø¯Ù‚ÙŠÙ‚ØŸ <i data-lucide="thumbs-up" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

            } catch (err) {
                console.error(err);
                alert("AI Error");
            }

            // 5. Hide Loader & Append Message
            loader.classList.add('hidden');
            chatContainer.insertAdjacentHTML('beforeend', aiResponseHtml);
            
            // Re-init icons for new content
            lucide.createIcons();
            
            // Scroll to bottom
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
    </script>
</body>
</html>